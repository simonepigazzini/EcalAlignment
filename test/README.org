** Dumping information from data or MC

    - Data
    #+BEGIN_EXAMPLE
    cmsenv
    voms-proxy-init --voms cms
    cmsDriver.py reco -s RAW2DIGI,L1Reco,RECO --conditions 101X_dataRun2_Prompt_v9 --data --filein=/store/data/Run2018A/EGamma/MINIAOD/PromptReco-v1/000/315/257/00000/6AB583CF-4D4B-E811-BE94-FA163EFC4E1B.root
    cmsRun Dump_DATA_cfg.py inputFiles=/store/data/Run2018A/EGamma/MINIAOD/PromptReco-v1/000/315/257/00000/6AB583CF-4D4B-E811-BE94-FA163EFC4E1B.root outputFile=output.root
    #+END_EXAMPLE

    - MC (This step gives the values of DEta and DPhi in MC)
    #+BEGIN_EXAMPLE
    cmsenv
    voms-proxy-init --voms cms
    cmsRun Dump_MC_cfg.py inputFiles=/store/mc/RunIISpring18MiniAOD/ZToEE_NNPDF30_13TeV-powheg_M_50_120/MINIAODSIM/NZSPU40to70_100X_upgrade2018_realistic_v10-v2/70000/24A70308-1124-E811-9609-0CC47A4D769E.root outputFile=output.root
    #+END_EXAMPLE


** Get alignment coefficients out of the trees created in the previous step

   - \chi^{2} minimization procedure is done for each supermodule (SM) in the ECAL barrel (EB) and each Dee in the ECAL endcap (EE)
   - There are 2 separate scripts for EB and EE. Both of them take the SM number and Dee number as an input argument. This allows us to perform the minimization in parallel across all of the ECAL elements.
   - This process can be done individually for each SM and Dee as follows:
   #+BEGIN_EXAMPLE
   EB_Alignment_RotoTraslation_singleSM     align/AlignEB_Zee_cfg.py  <iSM> (iSM ranges from 0 to 35)
   EE_Alignment_RotoTraslation_singleSM     align/AlignEE_Zee_cfg.py  <iDee> (iDee ranges from 0 to 3)

   Eg: To run minimization on iSM=0: EB_Alignment_RotoTraslation_singleSM     align/AlignEB_Zee_cfg.py  0
   Eg: To run minimization on iDee=0: EE_Alignment_RotoTraslation_singleSM     align/AlignEE_Zee_cfg.py  0
   #+END_EXAMPLE
   - The process can also be done all at once using [[file:align/doAlign.py][this]] script as follows. This will run the minimization process on each SM and Dee and combine the different output txt files into one txt file.
   #+BEGIN_EXAMPLE
   python align/doAlign.py -o <output file extension> -r <region>

   Eg: python align/doAlign.py -o Run3 -r EB
       python align/doAlign.py -o Run3 -r EE
       python align/doAlign.py -o Run3 -r All
   Make sure that the output txt files look sensible. For eg: the combined txt file for EB should have 36 rows and for EE should have four rows.
   #+END_EXAMPLE

** Combine alignment coefficients with previous alignment coefficients
   - CombineRotoTraslations   <previous alignment txt file>    <new alignment txt file obtained in previous step>    <output new txt file>

   #+BEGIN_EXAMPLE
    CombineRotoTraslations   myEBAlignment_2018.txt  myEBAlignment_Run3.txt  myEBAlignment_Run3_NewConditions.txt
    CombineRotoTraslations   myEEAlignment_2018.txt  myEEAlignment_Run3.txt  myEEAlignment_Run3_NewConditions.txt
   #+END_EXAMPLE



CombineRotoTraslations
====

    CombineRotoTraslations   origin.txt    modification.txt    new.txt
    CombineRotoTraslations   /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/1Mar2011/myEEAlignment_2010.txt   myEEAlignment_2011.txt    myEEAlignment_2011_combined.txt

    CombineRotoTraslations   /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2015/05Sep/myEBAlignment_2015.txt  myEBAlignment_2015_NewTrkAlign_13Oct2015.txt    myEBAlignment_2015_combined.txt
    CombineRotoTraslations   /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2015/05Sep/myEEAlignment_2015.txt  myEEAlignment_2015_NewTrkAlign_13Oct2015.txt    myEEAlignment_2015_combined.txt

    CombineRotoTraslations  /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2015/14Oct/myEBAlignment_2015.txt   myEBAlignment_2015_NewTrkAlign_23Oct2015.txt    myEBAlignment_2015_combined.txt

    CombineRotoTraslations  myEBAlignment_2015_combined.txt   myEBAlignment_2015_NewTrkAlign_26Oct2015.txt   myEBAlignment_2015_combined_27Oct.txt
    CombineRotoTraslations  myEEAlignment_2015_combined.txt   myEEAlignment_2015_NewTrkAlign_26Oct2015.txt   myEEAlignment_2015_combined_27Oct.txt

    /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2015/29Oct/
    CombineRotoTraslations  myEBAlignment_2015_combined_27Oct.txt   myEBAlignment_2015_18Jan2016_0Tesla.txt  myEBAlignment_2015_0Tesla_combined.txt
    CombineRotoTraslations  myEEAlignment_2015_combined_27Oct.txt   myEEAlignment_2015_18Jan2016_0Tesla.txt  myEEAlignment_2015_0Tesla_combined.txt

    CombineRotoTraslations  myEEAlignment_2015_0Tesla_combined.txt  myEEAlignment_2015_19Jan2016_0Tesla.txt  myEEAlignment_2015_0Tesla_19Jan_combined.txt


    CombineRotoTraslations     /afs/cern.ch/work/a/amassiro/ECALAlignment/CMSSW_7_4_14/src/EcalValidation/EcalAlignment/test/myEEAlignment_2015_combined_27Oct.txt                                  macro/newForEE.txt                                     myEEAlignment_2016_combined_19Apr.txt

    cp /afs/cern.ch/work/a/amassiro/ECALAlignment/CMSSW_7_4_14/src/EcalValidation/EcalAlignment/test/myEEAlignment_2015_combined_27Oct.txt   myEEAlignment_2015_combined_27Oct_modified.txt
    CombineRotoTraslations     myEEAlignment_2015_combined_27Oct_modified.txt                                  macro/newForEE.txt                                     myEEAlignment_2016_combined_27Apr.txt


    cp /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2016/Jun01/myEEAlignment_2016.txt     myEEAlignment_2016_0TeslaShifted.txt
    /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2016/20Jan/myEEAlignment_2015_0Tesla_combined.txt
    /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2015/29Oct/myEEAlignment_2015_combined_27Oct.txt



    CombineRotoTraslations  /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2016/Jun01/myEBAlignment_2016.txt   myEBAlignment_2017_preliminary.txt   myEBAlignment_2017_combined.txt
    CombineRotoTraslations  /afs/cern.ch/user/a/amassiro/public/ECAL_Alignment/2016/Jun01/myEEAlignment_2016.txt   myEEAlignment_2017_preliminary_onlytranslation.txt   myEEAlignment_2017_combined.txt


e.g.

    subtract two tags
    CombineRotoTraslations   myEEAlignment_2011.txt   myEEAlignment_2012.txt    myEEAlignment_2011_2012_difference.txt
    CombineRotoTraslations   myEBAlignment_2011.txt   myEBAlignment_2012.txt    myEBAlignment_2011_2012_difference.txt


Create local sqlite db
====


    cmsRun  copyFileAlignEE_cfg.py
    cmsRun  copyFileAlignEB_cfg.py



Check alignment in GT
====

Tag used for alignment:

    conddb list 74X_dataRun2_Prompt_v0 |grep EEAlig
    EEAlignmentRcd - EEAlignment_measured_v02_express

Check time when payloads have been prepared:

    conddb list EEAlignment_measured_v02_express

    Since   Insertion Time Payload                                   Object Type ------ -------------------  ---------------------------------------- ----------- 1       2008-01-01 00:00:42 0ea551bf621ce4610d0a86a8fb854c6cfe8b297c  Alignments 164492 2008-01-01 00:00:42  da6ea141a70d5d97eba7f895ff617d19f478ddde Alignments 184519  2008-01-01 00:00:42 049a24d4eca8dc8bfa35092de7ed079d5fda056d  Alignments

Dump last payload:

    conddb dump --type payload --format xml 049a24d4eca8dc8bfa35092de7ed079d5fda056d > dump.xml



PickEvent
====


    edmPickEvents.py  "/DoubleEG/Run2015D-PromptReco-v4/MINIAOD" 254294:2:131

    edmCopyPickMerge outputFile=pickevents.root \
       eventsToProcess=207279:114339019 \
       inputFiles=/store/data/Run2012D/MuEG/AOD/PromptReco-v1/000/207/279/3ECCEBEF-6831-E211-99E5-003048D2BC5C.root
